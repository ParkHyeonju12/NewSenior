<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="club">
	<insert id="insertClub" parameterType="c">
		insert into clubs values (clubs_seq.nextval, #{clubName }, #{clubCategory }, #{clubLimit }, #{clubLeader }, #{clubMainImg }, #{clubIntro })
	</insert>
	<select id="selectAllClub" resultType="c">
		select
			club_no as clubNo,
			club_name as clubName,
			club_category as clubCategory,
			club_limit as clubLimit,
			club_Leader as clubLeader,
			filepath as clubMainImg,
			club_intro as clubIntro
		from clubs
		<!-- 세션 들어오면 category로 if문 추가 예정 -->
	</select>
	<select id="selectOneClub" parameterType="int" resultType="c">
		select
			club_no as clubNo,
			club_name as clubName,
			club_category as clubCategory,
			club_limit as clubLimit,
			club_Leader as clubLeader,
			filepath as clubMainImg,
			club_intro as clubIntro
		from clubs
		where club_no = #{clubNo }
	</select>
	<insert id="insertChat" parameterType="cr">
		insert into chat_record values (chat_record_seq.nextval, #{chatClub }, #{chatMember }, #{chatContent }, to_char(sysdate, 'yyyy-mm-dd'), #{filepath } )
	</insert>
	<select id="selectAllClubBoard" parameterType="int" resultType="cb">
		select
			club_board_no as clubBoardNo,
			club_no as clubNo,
			(select nickname from members m where m.member_no = c.member_no) as clubBoardWriter,
			club_board_content as clubBoardContent,
			club_board_date as clubBoardDate,
			filepath as clubBoardFilepath
		from club_boards c
		where club_no = #{clubNo }
		order by club_board_date desc
	</select>
	<insert id="insertClubBoard" parameterType="cb">
		insert into club_boards values (club_boards_seq.nextval, #{clubNo }, #{memberNo }, #{clubBoardContent }, to_char(sysdate, 'yyyy-mm-dd'), #{clubBoardFilepath })
	</insert>
	<select id="getClubChatRecord" parameterType="int" resultType="cr">
	select
	    chat_record_no as chatNo,
	    chat_club as chatClub,
	    chat_member as chatMember,
	    chat_content as chatContent,
	    chat_date as chatDate,
	    filepath
	from chat_record
	where chat_club=#{param }
	</select>
</mapper>
