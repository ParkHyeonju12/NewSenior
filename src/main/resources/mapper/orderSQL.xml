<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="order">

<!-- 
<select id="a" resultType="Or" parameterType="m" resultMap="getBoard">
	select
	    *
    from pays
	where member_no=#{memberNo}
</select>
 -->

<select id="selectAllOrderHistory" parameterType="_int" resultType="Or">
	select
	    order_no as orderNo,
	    order_date as orderDate,
	    receive_name as receiveName,
	    receive_addr as receiveAddr,
	    receive_phone as receivePhone,
	    order_amount as orderAmount,
	    order_price as orderPrice,
	    member_no as memberNo
    from pays
	where member_no=#{memberNo}
</select>


<select id="selectOrderDetail" resultType="Or" parameterType="Or">
	select
		pay_details.order_no as orderNo,
		order_date as orderDate,
		order_detail_amount as orderDetailAmount,
		(select product_name from products where products.product_no=pay_details.product_no) as productName,
		receive_phone as receivePhone,
		receive_addr as receiveAddr,
		receive_name as receiveName,
		member_no as memberNo
	from pays, pay_details
	where pay_details.order_no=#{orderNo} and member_no=#{memberNo}
</select>

<insert id="insertOrder" parameterType="Or">
	insert into pays values(
	pays_seq.nextval,
	#{memberNo},
	to_char(sysdate,'yyyy-mm-dd'),
	#{buyAmount},
	#{buyPrice},
	#{receiveName},
	#{receiveAddr},
	#{receivePhone}
	)
</insert>





<select id="goOrderHistory" resultType="Or" parameterType="_int">
	select
	    product_no as productNo,
	    (select PRODUCT_PRICE from products where products.product_no=carts.product_no)as buyPrice,
	    (select product_name from products where products.product_no=carts.product_no) as buyName,
	    buy_amount as buyAmount,
	    member_no as memberNo
	from carts
	where member_no=#{memberNo}
</select>



	


</mapper>