<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="product">
  <select id="allProduct" parameterType="map" resultType="p">
  select * from
  	(select rownum as rnum, p.* from
  	(select 
  		product_no as productNo,
  		product_name as productName,
  		product_price as productPrice,
  		to_char(product_price, '999,999,999') as wonprice,
  		product_status as productStatus,
  		product_category as productCategory,
  		product_subname as productSubName,
  		product_qty as productQty,
  		product_content as productContent
  	from products order by 1 desc)p)
  	where rnum between #{start} and #{end}
  </select>
  <select id="selectCount" resultType="int">
  	select count(*) from products
  </select>
  <insert id="insertProduct" parameterType="p">
  	insert into products values(products_seq.nextval,#{productName},#{productPrice},#{productStatus},#{productCategory},#{productSubName},#{productQty},#{productContent})
  	<selectKey resultType="int" order="AFTER" keyProperty="productNo">
  		select max(product_no) from products
  	</selectKey>
  </insert>
  <insert id="insertProductFile" parameterType="pf">
  	insert into product_file values(product_fileseq.nextval,#{productNo},#{fileName},#{filePath})
  </insert>
  <select id="allProductFile" parameterType="_int" resultType="pf">
  	select 
  		product_fileno as fileNo,
  		product_no as productNo,
  		product_filename as fileName,
  		product_filepath as filePath
  	from
  		product_file
  	where 
  		product_no = #{_parameter}
  </select>
  <select id="productView" parameterType="_int" resultType="p">
  	select
  		product_no as productNo,
  		product_name as productName,
  		product_price as productPrice,
  		to_char(product_price, '999,999,999') as wonprice,
  		product_status as productStatus,
  		product_category as productCategory,
  		product_subname as productSubName,
  		product_qty as productQty,
  		product_content as productContent
  	from products
  	where product_no = #{_parameter}
  </select>
</mapper>
